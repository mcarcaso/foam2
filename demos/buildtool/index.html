<html>
  <head>
    <script src="/src/foam.js"></script>
  </head>
  <body>
    <script>
      var cl = foam.__context__.classloader;

      var l = document.location;
      var demoPath = l.protocol + '//' + l.host + '/demos/buildtool/';
      cl.addClassPath(demoPath + 'build', true);

      // Load from json2 first.
      var d = cl.modelDAO.delegate;
      cl.modelDAO.delegate = cl.modelDAO.primary;
      cl.modelDAO.primary = d;

      cl.load('foam.tools.WebAppConfigLoader').then(function(cls) {
        return cls.create().load(demoPath + 'config.js')
      }).then(function() {
        var m = demo.build.ModelToBuild.create();
        var stack = foam.u2.stack.StackView.create(null, m);
        stack.data.push({
          class: 'foam.u2.DetailView',
          data: m,
        }, m);
        stack.write()
      });
    </script>
  </body>
</html>
